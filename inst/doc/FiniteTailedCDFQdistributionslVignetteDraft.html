<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Smithson, Yiyun Shou" />


<title>Finite-Tailed CDF-Quantile Distribution Vignettes</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Finite-Tailed CDF-Quantile Distribution Vignettes</h1>
<h4 class="author">Michael Smithson, Yiyun Shou</h4>



<div id="modeling-proportion-of-patient-time-in-emergency-ward-stages" class="section level1">
<h1>Modeling Proportion of Patient Time in Emergency Ward Stages</h1>
<div id="about-the-data" class="section level2">
<h2>About the Data</h2>
<p>Yoon, Steiner, and Reinhardt (2003) conducted a study of time spent by patients admitted to the emergency department of the University of Alberta Hospital between midnight January 23 and midnight January 29, 1999, for five stages of ED assessment and treatment: Registration, triage assessment, nursing assessment, physician assessment, and disposition decision. While Yoon, et al. analyzed predictors of the total length of stay in the emergency ward, we will follow the analyses in Smithson and Broomell (2022), who examine the proportions of the patients’ stays in the various stages.</p>
<p>Smithson and Broomell observed that the data include a substantial number of zeros (e.g., 696 out of 894 patients spending no time in the decision stage). They reduced the zeros by aggregating the decision and physician stages, and aggregating the registration and triage stages. The resulting composition had three parts: Registration-triage, nursing assessment, and physician-decision. We will use that composition here.</p>
<p>Our example focuses on the proportion of time spent in the Registration-triage stage. Patients arriving by ambulance tended to have more life-threatening conditions than those arriving as ``walk-ins’’, so we expect to find that the ambulance-arrivals spend a smaller proportion of their time in this preliminary stage because many of them need to be rushed into treatment. The more serious cases also typically required lengthy nursing and treatment times, so excpect that longer length of stay will predict a lower proportion of time spent in the Registration-triage stage.</p>
<p>A quick examination of the relevant variables reveals that the log of the length of stay adequately corrects skew in that variable, and the split between ambulance-arrivals and walk-ins has adequate numbers of cases in both categories.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ambulance-arrival vs walk-in split shows 683 walk-ins and 211 ambulance-arrivals</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(yoon<span class="sc">$</span>Ambulance)</span></code></pre></div>
<pre><code>## 
##   0   1 
## 683 211</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Length of stay (in hours) is skewed, but the log of it isn&#39;t:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(yoon<span class="sc">$</span>LOSh, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;LOS&quot;</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(yoon<span class="sc">$</span>LOSh, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ln(LOS)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtrZmtv+QOgCQ2/+2ZgC2//++vr7bkDrb////tmb/25D//7b//9v///8WhpD5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHs0lEQVR4nO2diXqjNhRGSZt42ngahzHBNu//oEUSYjPwSyCwlv98szgxXJwToY2LyCqySPbqD+A7FASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAAcIyrKQfwtHCLqmI+hxySR//bE5RDqCiuxTvSj1C6NDJCPocWm1FO8/5odIRtD9/KVflhYnWTqCrEtQJhuwdATVdVBThAzroOx6TUtQfZKpVsywBkpPkG1wCtJRWobfTk5QnmUfsrP4NbNB4oJE25VnH6Iumqmk++Fqj4kJks18+fZdzTfzA0HX1ATJjqLqIs51FCMWVLfgH2Db1EtQUVcay/2/tg7q9alnw8UnqMKOrFqxGAUpRVazPfPhIhRUyrLxuFjMZSyEi02QGGcpMzZzGbPhohN0P8vmyVW4KjpB7sNFJyivTzCryeblcNEJymUFdD+j7qJhuOgE6QnnDTV0tSAo2KuH7cfWneNiJ0GhFqPuY6sJ59tpUyX0LEhMesQhqHZT/zAb2/pnQeJPJIJch6OgpXDq1IpK0KrEhNlwSkxUgvJNZsbh4hM0Ow9vFOXpsk+MguYmwVaFi0/Q47JpjDEOF5+gepzqoAhFLEjnJbAVG7JbP2ggqBlvhMgxgppiFCK9j12fZO8/uaMJswgFlW/fxfvPpu5Q1ILEfJC4cupoPig+QaKjKAQ5mlGcEBTmpOJTCcrXXzWslgVdgyxE4zqo2NZdjFmQ6iq6mlGMUZDTcBQEwsUnyGgsBmcdIxbUsNjK49uh4hdU5fPTQgY3syQgaKEIGdwOlYCghaEGS1AFsjvw7VBQUHDjjadWbHGkATfCgkIrRkf3gxIVhK6L6X8CnHp97ijiefvbaXZACwQFOC80vuyzNJo3cGgiKKx6ujcfpMws3c/cNF4bS1BYzX13iv1WEx2LY437WehLU5AuQWBGMX/7TlSQvhEMzZjVA9ZEBak6GM9I305/JyrIlMdlvqWjINNwy4ICaugPvPQ8+GLTUY7kwEvPgQva/9Jz4IL2v/QcuKBDLj2HLOiQS89BCzri0nPYgpyGi0/Q7GoT68LFJ2jXTPsYBG1s38fh4hO0ayJ5DIIch0OCghmvHnvZZ/CFkyPvjvqYbmroNlym1neLTZCLhr4RdJ1xQkEUZBSOgkA4CgLhKAiEMxfkf39ICzJO7TAJZyqoWe3Va0u79KTNBOnFK6rWltvP4oYXCmpLUiPIz1rJK0E+FiIPBHXLTvvYtHkgaFgh+YYvgrztHFEQwDdB3lXTvgnyrgz5J2ji+RyvxD9B1+ZUG1nqvtavjvFodwjDWzIdCHqqkLoaXL86pk63OoTpLZmuBDV9a/VPK0yJMR7obixoNvsa31DnTtC1t9apqsGVGN2vzHAxGmxhb8tm8/lbMkeXfTKv2U/Qymccho1lHWT3hLoYsCtwlk+oiwF/emSesoug11bCCB8ErXnr9e+42Hxz0NdroKDV77jYfHPQ12ugoNXvuNh8c9DXa6Cg1e+42Hxz0NdroKDV77jYPD0oCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwL2gcnb5BnXZ0eoxZrd//tjtKBN0PtcdbBLngsRaceW0odsv23Uv7meZJGG+4+NSH7oQXuwPNo1rQSrBYXpZc+s788smVct8R7VAn1gDyckyAJV7Qd0nfKawLPBl9ql+TOsdRTFy8UTCagdBsmRP//ryf5v6wRwVyHZH8UTUFQebxLUgVf1MVkJqnVO7VeSkINsdRXLOmoNNcqCgZgOruqG3tfGOZdd2OaiIjjzF1Abzy3hO0AtkumM/ucvuYJMcWUmrDaya374gsx2LfsXjoK0/sJlX7lacYjY76izBNQeb5MiOotS2opK22PF20lutONgk7ocaxfxKcXnd8tpVCk0RMN6xUElk4gPYH2wSDlYBFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIA3ggbPPhEPnu49S/B2aq+zy+xemXb2200WK8JPQSIDsxMkU1puJ5GuUUpP4oncVXnMKk9eCpKvW0FNFpR8AqxKPHpcPrrHm++MT4Lu5//O8lSSSS+tIJ2NVbz/SDOaYxaa80uQyG+u/6rkp+bnb58dLFOzejcXLGSKOsQvQZ8yd04p6QQ1p5LMqhP1dZNX5yBD0wC/BH11/88IquT9KrLsbHwstSE+ClImJk+xhlzll6cqaFiC+pW0LkTSVcqC+nWQPrXEd3Ur1ssO3hsfBQ1bsVFHUXxXJdOn2Io1glQ/SGX0ChXjoYYyk1g/qI/RMymdPbhyGS8FGd0Nl9pYbIDBOCu50byvUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA/8OIwWyZ0cyUAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(yoon<span class="sc">$</span>LOSh), <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ln(LOS)&quot;</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>loglosh <span class="ot">&lt;-</span> <span class="fu">log</span>(yoon<span class="sc">$</span>LOSh)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code></pre></div>
</div>
<div id="model-fitting" class="section level2">
<h2>Model Fitting</h2>
<p>This example compares outer-position distributions for goodness-of-fit. The Cauchit-ArcSinh outer-W model turns out to have the best fit, and it identifies significant effects of both ambulance arrival and log of length of stay in the expected directions for the <span class="math inline">\(\theta\)</span> (location) submodel. Note that the coefficients are positive for Ambulance and loglosh, because <span class="math inline">\(\theta\)</span> tracks skew and therefore a positive coefficient predicts a decrease in the median proportion of time spent in the Registration-triage stage.</p>
<p>There is only a marginally significant effect of loglosh in the <span class="math inline">\(\sigma\)</span> (dispersion) submodel. Nonetheless, a model without the dispersion submodel effects suffers a significant decline in goodness-of-fit. However, a model with interaction-effect terms does not significantly improve fit over the main-effects model.</p>
<p>Does a 3-parameter model contribute anything more? Note that we cannot compare 2- and 3-parameer models with likelihood-ratio tests because they are not nested. However, we can examine their AIC values. These turn out to be nearly identical, with the 2-parameter AIC slightly smaller. Moreover, there are no significant effects in the <span class="math inline">\(\mu\)</span> submodel, so the 2-paraameter model appears to be our best alternative.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine alternative distribution models&#39; goodness-of-fit:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;V&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit1)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 911.3165 (df=6)</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;cauchy&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;V&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit2)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 897.9554 (df=6)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;V&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit3)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 922.6401 (df=6)</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit4)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 935.8294 (df=6)</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;cauchy&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;V&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit5)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 883.0797 (df=6)</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;cauchy&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit6)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 928.6193 (df=6)</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit7 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;t2&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;t2&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;V&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit7)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 927.1892 (df=6)</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit8 <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;t2&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;t2&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">logLik</span>(fit8)</span></code></pre></div>
<pre><code>## &#39;log Lik.&#39; 880.8514 (df=6)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The Cauchit-ArcSinh outer-W model fits best.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4)</span></code></pre></div>
<pre><code>## Family:  cauchit arcsinh 
## Call:  cdfquantregFT(formula = pregptriage ~ Ambulance + loglosh | Ambulance +  
##     loglosh, data = yoon, fd = &quot;cauchit&quot;, sd = &quot;arcsinh&quot;, inner = FALSE,  
##     version = &quot;W&quot;) 
## 
## No coefficients in location submodel
## 
## Sigma coefficients (Dispersion submodel)
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)  -0.4177     0.1330  -3.141  0.00168 **
## Ambulance    -0.1109     0.6242  -0.178  0.85897   
## loglosh       0.2429     0.1323   1.835  0.06645 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Theta coefficients (Skewness submodel)
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.3622     0.1429   9.536  &lt; 2e-16 ***
## Ambulance     1.4479     0.6460   2.241    0.025 *  
## loglosh       0.6019     0.1389   4.335 1.46e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Converge:  successful completion
## Log-Likelihood:  935.8294</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Does a model without the effects in the dispersion submodel fit as well?</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The answer is no:</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>fit4b <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span><span class="dv">1</span>, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">anova</span>(fit4b, fit4)</span></code></pre></div>
<pre><code>## Likelihood ratio tests 
## 
##   Resid. Df -2Loglik Df LR stat  Pr(&gt;Chi)    
## 1       890  -1826.5                         
## 2       888  -1871.7  2  45.107 1.603e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># How about a 3-parameter model?</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>fit4c <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh<span class="sc">|</span>Ambulance <span class="sc">+</span> loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, mu.fo <span class="sc">~</span> Ambulance <span class="sc">+</span> loglosh, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">AIC</span>(fit4),<span class="fu">AIC</span>(fit4c))</span></code></pre></div>
<pre><code>## [1] -1859.659 -1859.998</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The AIC values are nearly identical.  Moroever, there are no significant $\mu$ effects:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4c)</span></code></pre></div>
<pre><code>## Family:  cauchit arcsinh 
## Call:  cdfquantregFT(formula = pregptriage ~ Ambulance + loglosh | Ambulance +  
##     loglosh, data = yoon, mu.fo = mu.fo ~ Ambulance + loglosh,  
##     fd = &quot;cauchit&quot;, sd = &quot;arcsinh&quot;, inner = FALSE, version = &quot;W&quot;) 
## 
## Mu coefficients (Location submodel)
##             Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)  -0.2159     0.1360  -1.587    0.112
## Ambulance     0.2287     0.3933   0.582    0.561
## loglosh      -0.1405     0.1419  -0.990    0.322
## 
## Sigma coefficients (Dispersion submodel)
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)  -0.3335     0.1218  -2.738  0.00617 **
## Ambulance    -0.2530     0.3097  -0.817  0.41397   
## loglosh       0.3163     0.1198   2.641  0.00827 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Theta coefficients (Skewness submodel)
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.1347     0.1701   6.670 2.56e-11 ***
## Ambulance     1.6702     0.3277   5.097 3.44e-07 ***
## loglosh       0.5586     0.1361   4.105 4.05e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Converge:  successful completion
## Log-Likelihood:  938.9992</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, what about a 2-parameter model with moderator effects?</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># No significant improvement in model fit:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fit4d <span class="ot">&lt;-</span> <span class="fu">cdfquantregFT</span>(pregptriage <span class="sc">~</span> Ambulance<span class="sc">*</span>loglosh<span class="sc">|</span>Ambulance<span class="sc">*</span>loglosh, <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>, <span class="at">data =</span> yoon); <span class="fu">anova</span>(fit4, fit4d)</span></code></pre></div>
<pre><code>## Likelihood ratio tests 
## 
##   Resid. Df -2Loglik Df LR stat Pr(&gt;Chi)
## 1       888  -1871.7                    
## 2       886  -1871.8  2 0.19441   0.9074</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code></pre></div>
</div>
<div id="model-evaluation" class="section level2">
<h2>Model Evaluation</h2>
<p>An examination of the parameter estimate correlation matrix reveals two correlations whose magnitudes are above 0.85, but the model appears stable and converges to the same solution from alternative starting-values.</p>
<p>The marginal fitted pdfs for the walk-ins and ambulance-arrivals correspond fairly closely to their repsective empirical distributions. The rank-order correlation between the fitted cdf and the dependent variable is 0.767, suggesting that the empirical quantiles are reasonably well modeled.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter-estimate correlations</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov2cor</span>(<span class="fu">vcov</span>(fit4))</span></code></pre></div>
<pre><code>##                     (sigma)_(Intercept) (sigma)_Ambulance (sigma)_loglosh
## (sigma)_(Intercept)         1.000000000       -0.01452776      -0.6743849
## (sigma)_Ambulance          -0.014527759        1.00000000      -0.1648889
## (sigma)_loglosh            -0.674384884       -0.16488894       1.0000000
## (theta)_(Intercept)        -0.803816131       -0.05094655       0.5617546
## (theta)_Ambulance           0.009483982       -0.98253988       0.1571836
## (theta)_loglosh             0.574435351        0.20734673      -0.9030172
##                     (theta)_(Intercept) (theta)_Ambulance (theta)_loglosh
## (sigma)_(Intercept)         -0.80381613       0.009483982       0.5744354
## (sigma)_Ambulance           -0.05094655      -0.982539881       0.2073467
## (sigma)_loglosh              0.56175458       0.157183639      -0.9030172
## (theta)_(Intercept)          1.00000000       0.046492189      -0.6838369
## (theta)_Ambulance            0.04649219       1.000000000      -0.2174752
## (theta)_loglosh             -0.68383687      -0.217475215       1.0000000</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the marginal distributions to the walk-ins:</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>uniqdat <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(yoon<span class="sc">$</span>pregptriage[yoon<span class="sc">$</span>Ambulance<span class="sc">==</span><span class="dv">0</span>]))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>densfit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(uniqdat)))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(uniqdat)) {</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  densfit[i] <span class="ot">&lt;-</span> <span class="fu">pdfft</span>(uniqdat[i], <span class="at">sigma =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit4)[<span class="dv">4</span>] <span class="sc">+</span> <span class="fu">mean</span>(loglosh)<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">6</span>]), <span class="at">theta =</span> <span class="fu">coef</span>(fit4)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">mean</span>(loglosh)<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">3</span>], <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">mu =</span> <span class="cn">NULL</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">truehist</span>(yoon<span class="sc">$</span>pregptriage[yoon<span class="sc">$</span>Ambulance<span class="sc">==</span><span class="dv">0</span>], <span class="at">nbins =</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Walk-ins&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;proportion&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pdf&quot;</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(uniqdat,densfit,<span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the marginal distributions to the ambulance-arrivals:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>uniqdat <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(yoon<span class="sc">$</span>pregptriage[yoon<span class="sc">$</span>Ambulance<span class="sc">==</span><span class="dv">1</span>]))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>densfit <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(uniqdat)))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(uniqdat)) {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  densfit[i] <span class="ot">&lt;-</span> <span class="fu">pdfft</span>(uniqdat[i], <span class="at">sigma =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit4)[<span class="dv">4</span>] <span class="sc">+</span> <span class="fu">coef</span>(fit4)[<span class="dv">5</span>] <span class="sc">+</span> <span class="fu">mean</span>(loglosh)<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">6</span>]), <span class="at">theta =</span> <span class="fu">coef</span>(fit4)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(fit4)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fu">mean</span>(loglosh)<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">3</span>], <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">mu =</span> <span class="cn">NULL</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">truehist</span>(yoon<span class="sc">$</span>pregptriage[yoon<span class="sc">$</span>Ambulance<span class="sc">==</span><span class="dv">1</span>], <span class="at">nbins =</span> <span class="dv">100</span>, <span class="at">main =</span> <span class="st">&quot;Ambulance-arrivals&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;proportion&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pdf&quot;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(uniqdat,densfit,<span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The fitted cdf should be monotonically related to the dependent variable.</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># How well does our model do?</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>fittedcdf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(yoon<span class="sc">$</span>pregptriage)))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(yoon<span class="sc">$</span>pregptriage)) {</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>fittedcdf[i] <span class="ot">&lt;-</span> <span class="fu">cdfft</span>(yoon<span class="sc">$</span>pregptriage[i], <span class="at">sigma =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit4)[<span class="dv">4</span>] <span class="sc">+</span> yoon<span class="sc">$</span>Ambulance[i]<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">5</span>] <span class="sc">+</span> loglosh[i]<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">6</span>]), <span class="at">theta =</span> <span class="fu">coef</span>(fit4)[<span class="dv">1</span>] <span class="sc">+</span> yoon<span class="sc">$</span>Ambulance[i]<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">2</span>] <span class="sc">+</span> loglosh[i]<span class="sc">*</span><span class="fu">coef</span>(fit4)[<span class="dv">3</span>], <span class="at">fd =</span> <span class="st">&quot;cauchit&quot;</span>, <span class="at">sd =</span> <span class="st">&quot;arcsinh&quot;</span>, <span class="at">mu =</span> <span class="cn">NULL</span>, <span class="at">inner =</span> <span class="cn">FALSE</span>, <span class="at">version =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(fittedcdf, yoon<span class="sc">$</span>pregptriage, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 0.7672581</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code></pre></div>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li><p>Yoon, P., Steiner, I. &amp; Reinhardt, G. (2003). Analysis of factors influencing length of stay in the emergency department.Canadian Journal of Emergency Medicine5, 155-161.</p></li>
<li><p>Smithson, M. &amp; Broomell, S.B. (online 31/01/2022). Compositional data analysis tutorial. Psychological Methods.</p></li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
